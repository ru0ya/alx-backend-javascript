"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
<<<<<<< HEAD
var _utils = require("@typescript-eslint/utils");
var _utils2 = require("./utils");
var _default = (0, _utils2.createRule)({
=======

var _experimentalUtils = require("@typescript-eslint/experimental-utils");

var _utils = require("./utils");

var _default = (0, _utils.createRule)({
>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
  name: __filename,
  meta: {
    docs: {
      category: 'Best Practices',
      description: 'Disallow Jasmine globals',
      recommended: 'error'
    },
    messages: {
      illegalGlobal: 'Illegal usage of global `{{ global }}`, prefer `{{ replacement }}`',
      illegalMethod: 'Illegal usage of `{{ method }}`, prefer `{{ replacement }}`',
      illegalFail: 'Illegal usage of `fail`, prefer throwing an error, or the `done.fail` callback',
      illegalPending: 'Illegal usage of `pending`, prefer explicitly skipping a test using `test.skip`',
      illegalJasmine: 'Illegal usage of jasmine global'
    },
    fixable: 'code',
    schema: [],
    type: 'suggestion'
  },
  defaultOptions: [],
<<<<<<< HEAD
  create(context) {
    return {
      CallExpression(node) {
        const {
          callee
        } = node;
        const calleeName = (0, _utils2.getNodeName)(callee);
        if (!calleeName) {
          return;
        }
        if (calleeName === 'spyOn' || calleeName === 'spyOnProperty' || calleeName === 'fail' || calleeName === 'pending') {
          if ((0, _utils2.resolveScope)(context.getScope(), calleeName)) {
            // It's a local variable, not a jasmine global.
            return;
          }
=======

  create(context) {
    return {
      CallExpression(node) {
        const callee = node.callee;
        const calleeName = (0, _utils.getNodeName)(callee);

        if (!calleeName) {
          return;
        }

        if (calleeName === 'spyOn' || calleeName === 'spyOnProperty' || calleeName === 'fail' || calleeName === 'pending') {
          if ((0, _utils.scopeHasLocalReference)(context.getScope(), calleeName)) {
            // It's a local variable, not a jasmine global.
            return;
          }

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
          switch (calleeName) {
            case 'spyOn':
            case 'spyOnProperty':
              context.report({
                node,
                messageId: 'illegalGlobal',
                data: {
                  global: calleeName,
                  replacement: 'jest.spyOn'
                }
              });
              break;
<<<<<<< HEAD
=======

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
            case 'fail':
              context.report({
                node,
                messageId: 'illegalFail'
              });
              break;
<<<<<<< HEAD
=======

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
            case 'pending':
              context.report({
                node,
                messageId: 'illegalPending'
              });
              break;
          }
<<<<<<< HEAD
          return;
        }
        if (callee.type === _utils.AST_NODE_TYPES.MemberExpression && calleeName.startsWith('jasmine.')) {
          const functionName = calleeName.replace('jasmine.', '');
=======

          return;
        }

        if (callee.type === _experimentalUtils.AST_NODE_TYPES.MemberExpression && calleeName.startsWith('jasmine.')) {
          const functionName = calleeName.replace('jasmine.', '');

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
          if (functionName === 'any' || functionName === 'anything' || functionName === 'arrayContaining' || functionName === 'objectContaining' || functionName === 'stringMatching') {
            context.report({
              fix: fixer => [fixer.replaceText(callee.object, 'expect')],
              node,
              messageId: 'illegalMethod',
              data: {
                method: calleeName,
                replacement: `expect.${functionName}`
              }
            });
            return;
          }
<<<<<<< HEAD
=======

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
          if (functionName === 'addMatchers') {
            context.report({
              node,
              messageId: 'illegalMethod',
              data: {
                method: calleeName,
                replacement: 'expect.extend'
              }
            });
            return;
          }
<<<<<<< HEAD
=======

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
          if (functionName === 'createSpy') {
            context.report({
              node,
              messageId: 'illegalMethod',
              data: {
                method: calleeName,
                replacement: 'jest.fn'
              }
            });
            return;
          }
<<<<<<< HEAD
=======

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
          context.report({
            node,
            messageId: 'illegalJasmine'
          });
        }
      },
<<<<<<< HEAD
      MemberExpression(node) {
        if ((0, _utils2.isSupportedAccessor)(node.object, 'jasmine')) {
          const {
            parent,
            property
          } = node;
          if (parent && parent.type === _utils.AST_NODE_TYPES.AssignmentExpression) {
            if ((0, _utils2.isSupportedAccessor)(property, 'DEFAULT_TIMEOUT_INTERVAL')) {
              const {
                right
              } = parent;
              if (right.type === _utils.AST_NODE_TYPES.Literal) {
=======

      MemberExpression(node) {
        if ('name' in node.object && node.object.name === 'jasmine') {
          const parent = node.parent,
                property = node.property;

          if (parent && parent.type === _experimentalUtils.AST_NODE_TYPES.AssignmentExpression) {
            if ('name' in property && property.name === 'DEFAULT_TIMEOUT_INTERVAL') {
              const right = parent.right;

              if (right.type === _experimentalUtils.AST_NODE_TYPES.Literal) {
>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
                context.report({
                  fix: fixer => [fixer.replaceText(parent, `jest.setTimeout(${right.value})`)],
                  node,
                  messageId: 'illegalJasmine'
                });
                return;
              }
            }
<<<<<<< HEAD
=======

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
            context.report({
              node,
              messageId: 'illegalJasmine'
            });
          }
        }
      }
<<<<<<< HEAD
    };
  }
});
=======

    };
  }

});

>>>>>>> 3593505a2789098f8b7e01cec0412530a8c77294
exports.default = _default;